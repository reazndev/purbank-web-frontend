<div class="transaction-container">
  <div class="transaction-header">
    <h2>{{ languageService.translate('transactions') }}</h2>
    <hr>
  </div>
<div class="transactions-wrapper" *ngIf="!isLoading; else loading">
  <ng-container *ngFor="let group of groupedTransactions">
    <div class="date-header" *ngIf="group.isPending">
      {{ languageService.translate('pendingPayments') }}
    </div>
    <div class="date-header" *ngIf="!group.isPending">
      {{ group.date | date:'fullDate' }}
    </div>
    <div class="transactions-grid">
      <div class="transaction-box" *ngFor="let transaction of group.transactions" [class.pending]="transaction.isPending">
        <span class="transaction-name">{{ transaction.message }}</span>
        <span class="transaction-balance" [class.negative]="transaction.amount < 0">
          {{ transaction.amount > 0 ? '' : '- ' }}{{ Math.abs(transaction.amount).toFixed(2) }} CHF
        </span>
        
        <button class="info-btn" (click)="showTransactionDetail(transaction)" title="View details">
          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-info"><circle cx="12" cy="12" r="10"></circle><path d="M12 16v-4"></path><path d="M12 8h.01"></path></svg>
        </button>
      </div>
    </div>
  </ng-container>
</div>
  <ng-template #loading>
    <div class="transactions-grid">
      <div class="transaction-box">Loading...</div>
    </div>
  </ng-template>
  <div class="transaction-footer">
    <a routerLink="/transactions">{{ languageService.translate('seeMore') }}</a>
  </div>
</div>

<div class="modal-overlay" *ngIf="showDetailModal" (click)="closeDetailModal()">
  <div class="detail-modal-content" (click)="$event.stopPropagation()">
    <div class="detail-header">
      <h2>{{ languageService.translate('transactionDetails') }}</h2>
      <button class="icon-btn" (click)="closeDetailModal()">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-x"><path d="M18 6 6 18"></path><path d="m6 6 12 12"></path></svg>
      </button>
    </div>
    <hr>
    <div class="detail-content" *ngIf="selectedTransaction">
      <div class="detail-row">
        <span class="detail-label">{{ languageService.translate('transactionName') }}:</span>
        <span class="detail-value">{{ selectedTransaction.name }}</span>
      </div>
      <div class="detail-row">
        <span class="detail-label">{{ languageService.translate('account') }}:</span>
        <span class="detail-value">{{ selectedTransaction.account }}</span>
      </div>
      <div class="detail-row">
        <span class="detail-label">{{ languageService.translate('toIban') }}:</span>
        <span class="detail-value">{{ selectedTransaction.toIban }}</span>
      </div>
      <div class="detail-row">
        <span class="detail-label">{{ languageService.translate('amount') }}:</span>
        <span class="detail-value" [class.positive]="selectedTransaction.amount > 0" [class.negative]="selectedTransaction.amount < 0">
          {{ selectedTransaction.amount > 0 ? '+' : '' }}{{ selectedTransaction.amount }} CHF
        </span>
      </div>
      <div class="detail-row">
        <span class="detail-label">{{ languageService.translate('message') }}:</span>
        <span class="detail-value">{{ selectedTransaction.message }}</span>
      </div>
      <div class="detail-row">
        <span class="detail-label">{{ languageService.translate('note') }}:</span>
        <span class="detail-value">{{ selectedTransaction.note }}</span>
      </div>
      <div class="detail-row">
        <span class="detail-label">{{ languageService.translate('executionType') }}:</span>
        <span class="detail-value">{{ selectedTransaction.executionType }}</span>
      </div>
      <div class="detail-row">
        <span class="detail-label">{{ languageService.translate('executionDate') }}:</span>
        <span class="detail-value">{{ selectedTransaction.executionDate }}</span>
      </div>
      <div class="detail-row">
        <span class="detail-label">{{ languageService.translate('locked') }}:</span>
        <span class="detail-value">{{ selectedTransaction.locked ? languageService.translate('yes') : languageService.translate('no') }}</span>
      </div>
    </div>
  </div>
</div>