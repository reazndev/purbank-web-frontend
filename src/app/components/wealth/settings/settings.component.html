<div class="settings-box">
  <div class="wealth-header">
    <h2>{{ languageService.translate('quickAction') }}</h2>
    <hr>
  </div>

  <div class="settings-nav">
    <a class="settings-link" (click)="openCreateModal()"><span class="settings-link-text">{{ languageService.translate('openNewAccount') }}</span></a>
    <a class="settings-link" (click)="openInviteModal()"><span class="settings-link-text">{{ languageService.translate('inviteMember') }}</span></a>
    <a class="settings-link" (click)="openDeleteModal()"><span class="settings-link-text">{{ languageService.translate('closeAccount') }}</span></a>
  </div>
</div>

<!-- Create Account Modal -->
<div class="modal-overlay" *ngIf="showCreateModal" (click)="closeCreateModal()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h2>{{ languageService.translate('openNewAccount') }}</h2>
      <button class="modal-close" (click)="closeCreateModal()">&times;</button>
    </div>
    <hr>
    <div class="modal-body">
      <div class="form-group">
        <label for="accountName">{{ languageService.translate('accountname') || 'Account Name' }}</label>
        <input 
          type="text" 
          id="accountName" 
          [(ngModel)]="accountName" 
          [disabled]="isSubmitting"
          class="form-input"
          placeholder="Enter account name"
          (keyup.enter)="createAccount()"
        />
      </div>

      <div class="error-message" *ngIf="errorMessage">{{ errorMessage }}</div>
      <div class="success-message" *ngIf="successMessage">{{ successMessage }}</div>
    </div>
    <div class="modal-footer">
      <button 
        class="btn-secondary" 
        (click)="closeCreateModal()" 
        [disabled]="isSubmitting"
      >
        {{ languageService.translate('cancel') || 'Cancel' }}
      </button>
      <button 
        class="btn-primary" 
        (click)="createAccount()" 
        [disabled]="isSubmitting || !accountName.trim()"
      >
        {{ isSubmitting ? 'Creating...' : (languageService.translate('create') || 'Create') }}
      </button>
    </div>
  </div>
</div>

<!-- Invite Member Modal -->
<div class="modal-overlay" *ngIf="showInviteModal" (click)="closeInviteModal()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h2>{{ languageService.translate('inviteMember') }}</h2>
      <button class="modal-close" (click)="closeInviteModal()">&times;</button>
    </div>
    <hr>
    <div class="modal-body">
      <div *ngIf="invitableAccounts.length > 0">
        <label>{{ languageService.translate('account') }}</label>
        <div class="account-selection-list">
          <div 
            *ngFor="let konto of invitableAccounts" 
            class="account-selection-item"
            [class.selected]="selectedAccountId === konto.kontoId"
            (click)="selectAccount(konto.kontoId)"
          >
            <span class="account-selection-name">{{ konto.kontoName }}</span>
            <span class="account-selection-iban-box">{{ konto.iban }}</span>
          </div>
        </div>

        <div class="form-group">
          <label for="contractNumber">{{ languageService.translate('contractNumber') }}</label>
          <input 
            type="text" 
            id="contractNumber" 
            [(ngModel)]="inviteContractNumber" 
            [disabled]="isSubmitting"
            class="form-input"
            placeholder="12345678"
          />
        </div>

        <div class="form-group">
          <label for="role">{{ languageService.translate('role') }}</label>
          <select 
            id="role" 
            [(ngModel)]="inviteRole" 
            [disabled]="isSubmitting"
            class="form-input"
          >
            <option value="VIEWER">{{ languageService.translate('viewer') }}</option>
            <option value="MANAGER">{{ languageService.translate('manager') }}</option>
            <option value="OWNER">{{ languageService.translate('owner') }}</option>
          </select>
        </div>
      </div>

      <div class="error-message" *ngIf="errorMessage">{{ errorMessage }}</div>
      <div class="success-message" *ngIf="successMessage">{{ successMessage }}</div>
    </div>
    <div class="modal-footer">
      <button 
        class="btn-secondary" 
        (click)="closeInviteModal()" 
        [disabled]="isSubmitting"
      >
        {{ languageService.translate('cancel') || 'Cancel' }}
      </button>
      <button 
        class="btn-primary" 
        (click)="inviteMember()" 
        [disabled]="isSubmitting || !selectedAccountId || !inviteContractNumber.trim() || invitableAccounts.length === 0"
      >
        {{ isSubmitting ? 'Inviting...' : (languageService.translate('inviteMember') || 'Invite') }}
      </button>
    </div>
  </div>
</div>

<div class="modal-overlay" *ngIf="showDeleteModal" (click)="closeDeleteModal()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h2>{{ languageService.translate('closeAccount') }}</h2>
      <button class="modal-close" (click)="closeDeleteModal()">&times;</button>
    </div>
    <hr>
    <div class="modal-body">
      <div class="warning-message">
        {{ languageService.translate('deleteAccountWarning') }}
      </div>

      <div *ngIf="deletableAccounts.length > 0">
        <div class="account-selection-list">
          <div 
            *ngFor="let konto of deletableAccounts" 
            class="account-selection-item"
            [class.selected]="selectedAccountId === konto.kontoId"
            (click)="selectAccount(konto.kontoId)"
          >
            <span class="account-selection-name">{{ konto.kontoName }}</span>
            <span class="account-selection-iban-box">{{ konto.iban }}</span>
          </div>
        </div>
      </div>

      <div class="error-message" *ngIf="errorMessage">{{ errorMessage }}</div>
      <div class="success-message" *ngIf="successMessage">{{ successMessage }}</div>
    </div>
    <div class="modal-footer">
      <button 
        class="btn-secondary" 
        (click)="closeDeleteModal()" 
        [disabled]="isSubmitting"
      >
        {{ languageService.translate('cancel') || 'Cancel' }}
      </button>
      <button 
        class="btn-delete" 
        (click)="deleteAccount()" 
        [disabled]="isSubmitting || !selectedAccountId || deletableAccounts.length === 0"
      >
        {{ isSubmitting ? 'Deleting...' : 'Delete Account' }}
      </button>
    </div>
  </div>
</div>
