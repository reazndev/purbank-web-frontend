<div class="transactions-list-container">
    <div class="list-header-section">
        <h2>{{ languageService.translate('allTransactions') }}</h2>
        <hr>
    </div>

    <div class="list-content custom-scrollbar">
        <div class="list-column-headers">
            <span class="column-label">{{ languageService.translate('message') }}</span>
            <span class="column-label">{{ languageService.translate('account') }}</span>
            <span class="column-label">{{ languageService.translate('iban') }}</span>
            <span class="column-label">{{ languageService.translate('note') }}</span>
            <span class="column-label align-right">{{ languageService.translate('amount') }}</span>
            <span class="column-label"></span>
        </div>

        <div *ngIf="isLoading" class="loading">{{ languageService.translate('loading') || 'Loading...' }}</div>
        
        <ng-container *ngFor="let group of groupedTransactions">
            <div class="date-header">{{ languageService.formatDate(group.date) }}</div>
            <div class="transaction-row" *ngFor="let transaction of group.transactions">
                <span class="transaction-value">{{ transaction.name }}</span>
                <span class="transaction-value">{{ transaction.account }}</span>
                <span class="transaction-value">{{ transaction.otherPartyIban }}</span>
                <span class="transaction-value">{{ transaction.note || '-' }}</span>
                <span class="transaction-balance" [class.positive]="transaction.amount > 0">
                     {{ transaction.amount > 0 ? '' : '- ' }}{{ MathAbs(transaction.amount) }} {{ transaction.currency }}
                </span>
                <button class="info-btn" (click)="showTransactionDetail(transaction)" [title]="languageService.translate('viewDetails')">
                  <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-info"><circle cx="12" cy="12" r="10"></circle><path d="M12 16v-4"></path><path d="M12 8h.01"></path></svg>
                </button>
            </div>
        </ng-container>

        <div *ngIf="!isLoading && groupedTransactions.length === 0" class="no-data">
            No transactions found.
        </div>
    </div>
</div>

<div class="modal-overlay" *ngIf="showDetailModal" (click)="closeDetailModal()">
  <div class="detail-modal-content" (click)="$event.stopPropagation()">
    <div class="detail-header">
      <h2>{{ selectedTransaction?.name }}</h2>
      <button class="icon-btn" (click)="closeDetailModal()">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-x"><path d="M18 6 6 18"></path><path d="m6 6 12 12"></path></svg>
      </button>
    </div>
    <hr>
    <div class="detail-content" *ngIf="selectedTransaction">
      <div class="detail-row">
        <span class="detail-label">{{ languageService.translate('account') }}:</span>
        <span class="detail-value">{{ selectedTransaction.account }}</span>
      </div>
      <div class="detail-row" *ngIf="selectedTransaction.transactionType === 'INCOMING'">
        <span class="detail-label">{{ languageService.translate('fromIban') }}:</span>
        <span class="detail-value">{{ selectedTransaction.otherPartyIban }}</span>
      </div>
      <div class="detail-row" *ngIf="selectedTransaction.transactionType === 'OUTGOING'">
        <span class="detail-label">{{ languageService.translate('toIban') }}:</span>
        <span class="detail-value">{{ selectedTransaction.otherPartyIban }}</span>
      </div>
      <div class="detail-row">
        <span class="detail-label">{{ languageService.translate('amount') }}:</span>
        <span class="detail-value" [class.positive]="selectedTransaction.amount > 0" [class.negative]="selectedTransaction.amount < 0">
          {{ selectedTransaction.amount > 0 ? '+' : '' }}{{ selectedTransaction.amount }} {{ selectedTransaction.currency }}
        </span>
      </div>
      <div class="detail-row">
        <span class="detail-label">{{ languageService.translate('message') }}:</span>
        <span class="detail-value">{{ selectedTransaction.name }}</span>
      </div>
      <div class="detail-row">
        <span class="detail-label">{{ languageService.translate('note') }}:</span>
        <span class="detail-value">{{ selectedTransaction.note }}</span>
      </div>
      <div class="detail-row">
        <span class="detail-label">{{ languageService.translate('executionDate') }}:</span>
        <span class="detail-value">{{ selectedTransaction.date }}</span>
      </div>
      <div class="detail-row" *ngIf="selectedTransaction.locked !== undefined">
        <span class="detail-label">{{ languageService.translate('locked') }}:</span>
        <span class="detail-value">{{ selectedTransaction.locked ? languageService.translate('yes') : languageService.translate('no') }}</span>
      </div>
    </div>
  </div>
</div>
